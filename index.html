<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bangla Earn Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; text-align:center; background:#f9f9f9;}
h1,h2 { color:#00a2ff; margin:10px 0;}
p,span { font-size:16px; color:#333;}
button { padding:10px 20px; margin:5px; font-size:16px; border:none; border-radius:8px; cursor:pointer; background:#00a2ff; color:#fff;}
button:hover { background:#0081cc;}
.page { display:none; padding-bottom:60px;}
.active { display:block;}
nav { position:fixed; bottom:0; width:100%; background:#eee; display:flex; justify-content:space-around; padding:5px 0;}
nav button { flex:1; margin:0; border-radius:0;}
input, select { padding:8px; margin:5px; width:80%; border-radius:6px; border:1px solid #ccc;}
#timer { font-size:18px; color:#ff5722; margin:10px;}
ul { list-style:none; padding:0;}
li { text-align:left; margin:5px 20px;}
</style>
</head>
<body>

<!-- Page 1: Registration -->
<div id="page-register" class="page active">
<h1>Bangla Earn Registration</h1>
<input type="text" id="regName" placeholder="নাম"><br>
<input type="text" id="regMobile" placeholder="মোবাইল নাম্বার"><br>
<select id="regPayment">
  <option value="Bikash">Bikash</option>
  <option value="Nagad">Nagad</option>
</select><br>
<input type="text" id="regAcc" placeholder="পেমেন্ট একাউন্ট নাম্বার"><br>
<button id="registerBtn">Register</button>
</div>

<!-- Page 2: Home -->
<div id="page-home" class="page">
<h1>Bangla Earn Home</h1>
<p>আজকের এড দেখা হয়েছে: <span id="adsCount">0</span>/100</p>
<button id="goEarn">Earn Page</button>
</div>

<!-- Page 3: Earn -->
<div id="page-earn" class="page">
<h1>Earn Page</h1>
<p>এড দেখো (1 টাকা / ad)</p>
<button id="adBtn">এড দেখো</button>
<div id="timer"></div>

<p>Daily Check-in</p>
<button id="checkinBtn">Check-in</button>
<p id="checkinMsg"></p>

<p>Daily Task</p>
<button id="taskBtn">Task Complete (10 টাকা)</button>
<p id="taskMsg"></p>
</div>

<!-- Page 4: Team / Referral -->
<div id="page-team" class="page">
<h1>Team / Referral</h1>
<p>তোমার রেফারাল লিংক: <span id="refLink">USER123</span> <button onclick="copyReferral()">Copy</button></p>
<p>Total Referral: <span id="totalRef">0</span></p>
<p>Total Referral Income: <span id="refIncome">0</span> টাকা</p>
<p>1st Generation Commission: <span id="gen1">0</span> টাকা</p>
<p>2nd Generation Commission: <span id="gen2">0</span> টাকা</p>
</div>

<!-- Page 5: Withdraw -->
<div id="page-withdraw" class="page">
<h1>Withdraw</h1>
<p>Min: 130, Max: 1010 টাকা</p>
<p>Payment Method: <span id="payMethod"></span></p>
<p>Account: <span id="payAcc"></span></p>
<input type="number" id="withdrawAmount" placeholder="টাকার পরিমান"><br>
<button id="withdrawBtn">Request Withdraw</button>
<p id="withdrawMsg"></p>
</div>

<!-- Page 6: History -->
<div id="page-history" class="page">
<h1>History</h1>
<h2>Earnings</h2>
<ul id="earnHistory"></ul>
<h2>Withdrawals</h2>
<ul id="withdrawHistory"></ul>
</div>

<!-- Page 7: Profile -->
<div id="page-profile" class="page">
<h1>Profile</h1>
<p>Name: <span id="profName"></span></p>
<p>Mobile: <span id="profMobile"></span></p>
<p>Payment Method: <span id="profMethod"></span></p>
<p>Account: <span id="profAcc"></span></p>
<p>Registration Date: <span id="profDate"></span></p>
</div>

<!-- Navigation -->
<nav>
<button onclick="showPage('page-home')">Home</button>
<button onclick="showPage('page-earn')">Earn</button>
<button onclick="showPage('page-team')">Team</button>
<button onclick="showPage('page-withdraw')">Withdraw</button>
<button onclick="showPage('page-history')">History</button>
<button onclick="showPage('page-profile')">Profile</button>
</nav>

<script>
// ----- Page Navigation -----
function showPage(pageId){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
}

// ----- Registration -----
document.getElementById('registerBtn').addEventListener('click',()=>{
    let name=document.getElementById('regName').value;
    let mobile=document.getElementById('regMobile').value;
    let method=document.getElementById('regPayment').value;
    let acc=document.getElementById('regAcc').value;
    if(!name||!mobile||!acc){ alert('সব ফিল্ড পূরণ করো'); return; }
    localStorage.setItem('userName',name);
    localStorage.setItem('userMobile',mobile);
    localStorage.setItem('userMethod',method);
    localStorage.setItem('userAcc',acc);
    localStorage.setItem('regDate',new Date().toLocaleDateString());
    alert('Registration Complete!');
    updateProfile();
    showPage('page-home');
});

// ----- Profile Update -----
function updateProfile(){
    document.getElementById('profName').innerText=localStorage.getItem('userName')||'';
    document.getElementById('profMobile').innerText=localStorage.getItem('userMobile')||'';
    document.getElementById('profMethod').innerText=localStorage.getItem('userMethod')||'';
    document.getElementById('profAcc').innerText=localStorage.getItem('userAcc')||'';
    document.getElementById('profDate').innerText=localStorage.getItem('regDate')||'';
    document.getElementById('payMethod').innerText=localStorage.getItem('userMethod')||'';
    document.getElementById('payAcc').innerText=localStorage.getItem('userAcc')||'';
}

// ----- Earn Page Logic -----
// Ads
const maxAdsPerDay=100;
const today=new Date().toISOString().slice(0,10);
let adsToday=JSON.parse(localStorage.getItem("ads_"+today))||0;
document.getElementById('adsCount').innerText=adsToday;

document.getElementById('adBtn').addEventListener('click',()=>{
    if(adsToday>=maxAdsPerDay){ alert("আজকের 100 এড limit শেষ!"); return; }
    const adLink="https://otieu.com/4/10476658";
    window.open(adLink,"_blank");
    let timeLeft=15;
    const timerDiv=document.getElementById("timer");
    timerDiv.innerText="⏳ "+timeLeft+" সেকেন্ড অপেক্ষা করো...";
    document.getElementById('adBtn').disabled=true;
    const countdown=setInterval(()=>{
        timeLeft--;
        timerDiv.innerText="⏳ "+timeLeft+" সেকেন্ড অপেক্ষা করো...";
        if(timeLeft<=0){
            clearInterval(countdown);
            timerDiv.innerText="";
            document.getElementById('adBtn').disabled=false;
            adsToday++;
            localStorage.setItem("ads_"+today,JSON.stringify(adsToday));
            document.getElementById('adsCount').innerText=adsToday;
            alert(`Ad complete! +1 টাকা balance-এ যোগ হয়েছে।`);
            let earnHist=JSON.parse(localStorage.getItem('earnHistory')||'[]');
            earnHist.push({date:new Date().toLocaleString(),amount:1});
            localStorage.setItem('earnHistory',JSON.stringify(earnHist));
        }
    },1000);
});

// Daily Check-in
document.getElementById('checkinBtn').addEventListener('click',()=>{
    const checkinKey="checkin_"+today;
    if(localStorage.getItem(checkinKey)){ alert("আজকে check-in করা হয়ে গেছে!"); return;}
    let dayCount = Number(localStorage.getItem("checkinDay")||0)+1;
    let reward = dayCount; // 1st day=1, 2nd day=2
    let earnHist=JSON.parse(localStorage.getItem('earnHistory')||'[]');
    earnHist.push({date:new Date().toLocaleString(),amount:reward});
    localStorage.setItem('earnHistory',JSON.stringify(earnHist));
    localStorage.setItem(checkinKey,true);
    localStorage.setItem("checkinDay",dayCount);
    alert(`Check-in Complete! +${reward} টাকা`);
    document.getElementById('checkinMsg').innerText=`আজকের check-in করা হয়েছে। (+${reward} টাকা)`;
});

// Daily Task
document.getElementById('taskBtn').addEventListener('click',()=>{
    const taskKey="task_"+today;
    if(localStorage.getItem(taskKey)){ alert("আজকের task করা হয়ে গেছে!"); return;}
    let earnHist=JSON.parse(localStorage.getItem('earnHistory')||'[]');
    earnHist.push({date:new Date().toLocaleString(),amount:10});
    localStorage.setItem('earnHistory',JSON.stringify(earnHist));
    localStorage.setItem(taskKey,true);
    alert("Daily Task Complete! +10 টাকা");
    document.getElementById('taskMsg').innerText="আজকের Daily Task সম্পন্ন হয়েছে (+10 টাকা)";
});

// ----- Team / Referral -----
const referralCode="USER123";
document.getElementById('refLink').innerText=referralCode;
function copyReferral(){ navigator.clipboard.writeText(referralCode); alert("Referral Copied!"); }
document.getElementById('totalRef').innerText=0;
document.getElementById('refIncome').innerText=0;
document.getElementById('gen1').innerText=0;
document.getElementById('gen2').innerText=0;

// ----- Withdraw -----
document.getElementById('withdrawBtn').addEventListener('click',()=>{
    let amount=Number(document.getElementById('withdrawAmount').value);
    if(amount<130){ alert("Minimum withdraw 130 টাকা"); return;}
    if(amount>1010){ alert("Maximum withdraw 1010 টাকা"); return;}
    let lastReq=Number(localStorage.getItem('lastWithdraw')||0);
    let now=Date.now();
    if(now-lastReq<15000){ alert("কিছুক্ষণ পর আবার চেষ্টা করো"); return; }
    localStorage.setItem('lastWithdraw',now);
    let wHist=JSON.parse(localStorage.getItem('withdrawHistory')||'[]');
    wHist.push({date:new Date().toLocaleString(),amount:amount});
    localStorage.setItem('withdrawHistory',JSON.stringify(wHist));
    document.getElementById('withdrawMsg').innerText="Withdraw Request Sent!";
});

// ----- History -----
function updateHistory(){
    let earnHist=JSON.parse(localStorage.getItem('earnHistory')||'[]');
    let wHist=JSON.parse(localStorage.getItem('withdrawHistory')||'[]');
    const eList=document.getElementById('earnHistory');
    const wList=document.getElementById('withdrawHistory');
    eList.innerHTML=""; wList.innerHTML="";
    earnHist.forEach(e=>{ let li=document.createElement('li'); li.innerText=`${e.date} → ${e.amount} টাকা`; eList.appendChild(li); });
    wHist.forEach(w=>{ let li=document.createElement('li'); li.innerText=`${w.date} → ${w.amount} টাকা`; wList.appendChild(li); });
}

// Load profile & history
updateProfile();
updateHistory();
</script>

</body>
  </html>
