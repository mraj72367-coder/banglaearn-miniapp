<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Bangla Earn Mini App</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial,sans-serif;background:#f2f5f9;margin:0;padding:0;}
.container{max-width:420px;margin:auto;padding:15px;}
.box{background:#fff;padding:20px;border-radius:12px;margin-bottom:15px;box-shadow:0 4px 12px rgba(0,0,0,.1);}
h1{text-align:center;color:#0a7cff;margin-bottom:15px;}
input, select{width:100%;padding:10px;margin:5px 0;border-radius:8px;border:1px solid #ccc;}
.btn{width:100%;padding:12px;margin-top:10px;border:none;border-radius:8px;font-size:16px;background:#0a7cff;color:#fff;cursor:pointer;}
.btn:disabled{background:#888;cursor:not-allowed;}
.navbar{display:flex;justify-content:space-between;background:#fff;position:fixed;bottom:0;width:100%;max-width:420px;margin:auto;padding:5px 0;box-shadow:0 -2px 6px rgba(0,0,0,.1);}
.navbar button{flex:1;margin:0 2px;padding:10px;font-size:14px;background:#e9eef3;border:none;border-radius:8px;cursor:pointer;}
.navbar button.active{background:#0a7cff;color:#fff;}
.balance{text-align:center;font-size:18px;font-weight:bold;margin-bottom:10px;}
.hidden{display:none;}
#timer{text-align:center;font-size:22px;margin:10px 0;}
.calendar span{display:inline-block;padding:6px 10px;margin:4px;border-radius:6px;background:#eee;}
.checked{background:#0a7cff;color:#fff;}
.refbox, .history-box{background:#f1f4f8;padding:10px;border-radius:8px;margin-top:10px;font-size:14px;}
</style>
</head>
<body>

<div class="container">

<!-- Page 1: Registration -->
<div class="box" id="page1">
<h1>Register Account</h1>
<input type="text" id="regName" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ">
<input type="text" id="regMobile" placeholder="‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞">
<select id="regMethod">
<option value="">‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
<option value="Bikash">Bikash</option>
<option value="Nagad">‡¶®‡¶ó‡¶¶</option>
</select>
<input type="text" id="regAcc" placeholder="Payment Account Number">
<button class="btn" onclick="registerUser()">Register</button>
<p id="regMsg" style="text-align:center;margin-top:10px;color:red;"></p>
</div>

<!-- Page 2: Home -->
<div class="box hidden" id="page2">
<h1>Bangla Earn</h1>
<div class="balance">üí∞ Balance: <span id="bal">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</div>
<p style="text-align:center;">Welcome, <span id="userName"></span></p>
</div>

<!-- Page 3: Earn -->
<div class="box hidden" id="page3">
<h1>Earn</h1>
<button class="btn" id="adBtn" onclick="startAd()">‚ñ∂Ô∏è Ad ‡¶¶‡ßá‡¶ñ‡ßã (1 ‡¶ü‡¶æ‡¶ï‡¶æ)</button>
<div id="timer"></div>
<button class="btn" onclick="checkIn()">üìÖ Daily Check-in</button>
<div class="calendar" id="calendar"></div>
<button class="btn" id="taskBtn" onclick="dailyTask()">üì∫ Daily Task (10 ‡¶ü‡¶æ‡¶ï‡¶æ)</button>
<p id="earnMsg" style="text-align:center;margin-top:10px;"></p>
</div>

<!-- Page 4: Team / Referral -->
<div class="box hidden" id="page4">
<h1>Team / Referral</h1>
<div class="refbox" id="refBox"></div>
</div>

<!-- Page 5: Withdraw -->
<div class="box hidden" id="page5">
<h1>Withdraw</h1>
<p>Payment Method: <span id="payMethod"></span></p>
<p>Account Number: <span id="payAcc"></span></p>
<input type="number" id="withdrawAmt" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶®">
<button class="btn" onclick="withdraw()">üí≥ Withdraw</button>
<p id="withdrawMsg" style="text-align:center;margin-top:10px;"></p>
</div>

<!-- Page 6: History -->
<div class="box hidden" id="page6">
<h1>History</h1>
<div class="history-box" id="historyBox"></div>
</div>

<!-- Page 7: Profile -->
<div class="box hidden" id="page7">
<h1>Profile</h1>
<p>‡¶®‡¶æ‡¶Æ: <span id="profileName"></span></p>
<p>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: <span id="profileMobile"></span></p>
<p>Payment Method: <span id="profileMethod"></span></p>
<p>Account: <span id="profileAcc"></span></p>
<p>Registered: <span id="profileDate"></span></p>
<button class="btn" onclick="editProfile()">Edit Profile</button>
</div>

<!-- Bottom Navigation -->
<div class="navbar">
<button onclick="nav(2)" id="navHome" class="active">Home</button>
<button onclick="nav(3)" id="navEarn">Earn</button>
<button onclick="nav(4)" id="navTeam">Team</button>
<button onclick="nav(5)" id="navWithdraw">Withdraw</button>
<button onclick="nav(6)" id="navHistory">History</button>
<button onclick="nav(7)" id="navProfile">Profile</button>
</div>

</div>

<script>
// --- Variables ---
let user = JSON.parse(localStorage.getItem("user")) || null;
let balance = Number(localStorage.getItem("bal")) || 0;
let adRunning = false;
let refCode = localStorage.getItem("refCode") || ("BE"+Math.floor(Math.random()*100000));
localStorage.setItem("refCode",refCode);
let referrals = JSON.parse(localStorage.getItem("refList")||"[]");
document.getElementById("bal").innerText = balance;

// --- Registration ---
function registerUser(){
    let name = document.getElementById("regName").value.trim();
    let mobile = document.getElementById("regMobile").value.trim();
    let method = document.getElementById("regMethod").value;
    let acc = document.getElementById("regAcc").value.trim();
    if(!name || !mobile || !method || !acc){document.getElementById("regMsg").innerText="‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®"; return;}
    if(user){document.getElementById("regMsg").innerText="‡¶è‡¶ï ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤‡ßá ‡¶è‡¶ï‡¶ü‡¶æ‡¶á ‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü allowed"; return;}
    user = {name,mobile,method,acc,date:new Date().toLocaleDateString()};
    localStorage.setItem("user",JSON.stringify(user));
    showHome();
}

// --- Navigation ---
function nav(page){
    for(let i=2;i<=7;i++){document.getElementById("page"+i).classList.add("hidden");document.getElementById("nav"+["Home","Earn","Team","Withdraw","History","Profile"][i-2]).classList.remove("active");}
    document.getElementById("page"+page).classList.remove("hidden");
    document.getElementById("nav"+["Home","Earn","Team","Withdraw","History","Profile"][page-2]).classList.add("active");
    if(page==2) showHome();
    if(page==4) showReferral();
    if(page==6) showHistory();
    if(page==7) showProfile();
}

// --- Home Page ---
function showHome(){
    if(!user) return; page1.classList.add("hidden"); page2.classList.remove("hidden");
    document.getElementById("userName").innerText = user.name;
    document.getElementById("bal").innerText = balance;
}

// --- Earn Page ---
function startAd(){
    if(adRunning)return;
    if(localStorage.getItem("adDone")==today()) return msg("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ Ad ‡¶∂‡ßá‡¶∑");
    adRunning=true; let t=15; document.getElementById("timer").innerText="‚è≥ "+t+"s";
    adBtn.disabled=true;
    let interval=setInterval(()=>{
        t--; document.getElementById("timer").innerText="‚è≥ "+t+"s";
        if(t==0){clearInterval(interval); document.getElementById("timer").innerText=""; balance+=1; localStorage.setItem("bal",balance); localStorage.setItem("adDone",today()); msg("Ad Complete +1"); adRunning=false; adBtn.disabled=false;}
    },1000);
}
function checkIn(){if(localStorage.getItem("checkin")==today()) return msg("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ Check-in ‡¶®‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá"); balance+=2; localStorage.setItem("bal",balance); localStorage.setItem("checkin",today()); renderCalendar(); msg("Check-in +2");}
function dailyTask(){if(localStorage.getItem("task")==today()) return msg("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ Task ‡¶∂‡ßá‡¶∑"); balance+=10; localStorage.setItem("bal",balance); localStorage.setItem("task",today()); msg("Task +10");}

// --- Calendar ---
function renderCalendar(){let d=new Date().getDate(); calendar.innerHTML=""; for(let i=1;i<=7;i++){let s=document.createElement("span"); s.innerText="Day "+i; if(i<=d%7)s.classList.add("checked"); calendar.appendChild(s);}}

// --- Referral / Team ---
function showReferral(){let box=document.getElementById("refBox"); let link=location.origin+location.pathname+"?ref="+refCode; box.innerHTML=`üîó Code: ${refCode}<br>Link:<br>${link}<br>Total Refer: ${referrals.length}<br>1st Gen Commission: ... <br>2nd Gen Commission: ...`;}

// --- Withdraw ---
function withdraw(){let amt = Number(document.getElementById("withdrawAmt").value); if(amt<130) return document.getElementById("withdrawMsg").innerText="Minimum 130 required"; if(amt>balance) return document.getElementById("withdrawMsg").innerText="Insufficient balance"; balance-=amt; localStorage.setItem("bal",balance); document.getElementById("withdrawMsg").innerText="Withdraw request sent (24h)"; showHistory();}

// --- History ---
function showHistory(){document.getElementById("historyBox").innerHTML=`Balance: ${balance}<br>Ad, Task, Check-in & Referral history here`;}

// --- Profile ---
function showProfile(){document.getElementById("profileName").innerText=user.name; document.getElementById("profileMobile").innerText=user.mobile; document.getElementById("profileMethod").innerText=user.method; document.getElementById("profileAcc").innerText=user.acc; document.getElementById("profileDate").innerText=user.date;}
function editProfile(){let newName=prompt("‡¶®‡¶§‡ßÅ‡¶® ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®:",user.name); if(newName){user.name=newName; localStorage.setItem("user",JSON.stringify(user)); showProfile(); showHome();}}

// --- Utility ---
function msg(t){document.getElementById("earnMsg").innerText=t;}
function today(){return new Date().toDateString();}

// --- Initial Load ---
if(user){page1.classList.add("hidden"); showHome();} else{page1.classList.remove("hidden");}
