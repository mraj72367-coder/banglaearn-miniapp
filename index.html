<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Bangla Earn Mini App</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#f2f5f9;padding:20px}
.box{background:#fff;padding:20px;border-radius:12px;max-width:420px;margin:auto;box-shadow:0 4px 12px rgba(0,0,0,.1)}
h1{text-align:center;color:#0a7cff}
.btn{width:100%;padding:12px;margin-top:10px;border:none;border-radius:8px;font-size:16px;background:#0a7cff;color:#fff}
.small{background:#e9eef3;color:#000}
.hidden{display:none}
.balance{text-align:center;font-size:18px;font-weight:bold}
.calendar span{display:inline-block;padding:6px 10px;margin:4px;border-radius:6px;background:#eee}
.checked{background:#0a7cff;color:#fff}
#timer{text-align:center;font-size:22px;margin-top:10px}
.refbox{background:#f1f4f8;padding:10px;border-radius:8px;margin-top:10px;font-size:14px}
</style>
</head>

<body>

<div class="box" id="home">
<h1>Bangla Earn</h1>
<p style="text-align:center;">Mini App à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦šà¦¾à¦²à§ à¦¹à§Ÿà§‡à¦›à§‡ âœ…</p>
<button class="btn" onclick="openEarn()">Earn Now</button>
</div>

<div class="box hidden" id="earn">
<h1>Earn Dashboard</h1>
<div class="balance">ğŸ’° Balance: <span id="bal">0</span> à¦Ÿà¦¾à¦•à¦¾</div>

<button class="btn" onclick="startAd()">â–¶ï¸ Ad à¦¦à§‡à¦–à§‹ (à§§ à¦Ÿà¦¾à¦•à¦¾)</button>
<div id="timer"></div>

<button class="btn" onclick="checkIn()">ğŸ“… Daily Check-in</button>
<div class="calendar" id="calendar"></div>

<button class="btn" onclick="dailyTask()">ğŸ“º Daily Task (10 à¦Ÿà¦¾à¦•à¦¾)</button>

<button class="btn" onclick="showReferral()">ğŸ‘¥ Referral</button>
<div id="referralBox" class="refbox hidden"></div>

<button class="btn small" onclick="withdraw()">ğŸ’³ Withdraw</button>
<button class="btn small" onclick="goBack()">â¬… Back</button>

<p id="msg" style="text-align:center;margin-top:10px;"></p>
</div>

<script>
let balance = Number(localStorage.getItem("bal")) || 0;
let refCode = localStorage.getItem("refCode") || ("BE"+Math.floor(Math.random()*100000));
localStorage.setItem("refCode",refCode);

let referrals = JSON.parse(localStorage.getItem("refList")||"[]");

document.getElementById("bal").innerText = balance;

// referral bonus on first open
let urlParams = new URLSearchParams(window.location.search);
let usedRef = urlParams.get("ref");
if(usedRef && !localStorage.getItem("refUsed")){
balance+=5;
save();
localStorage.setItem("refUsed","yes");
let list = JSON.parse(localStorage.getItem("refList")||"[]");
list.push("User joined via "+usedRef);
localStorage.setItem("refList",JSON.stringify(list));
}

function openEarn(){
home.classList.add("hidden");
earn.classList.remove("hidden");
renderCalendar();
}

function save(){
localStorage.setItem("bal",balance);
document.getElementById("bal").innerText=balance;
}

function startAd(){
if(localStorage.getItem("adDone")==today())return msg("âŒ à¦†à¦œà¦•à§‡à¦° Ad à¦¦à§‡à¦–à¦¾ à¦¶à§‡à¦·");
let t=15;
timer.innerText="â³ "+t+"s";
let i=setInterval(()=>{
t--;
timer.innerText="â³ "+t+"s";
if(t==0){
clearInterval(i);
timer.innerText="";
balance+=1;
localStorage.setItem("adDone",today());
save();
msg("âœ… Ad Complete +1 à¦Ÿà¦¾à¦•à¦¾");
}
},1000);
}

function checkIn(){
if(localStorage.getItem("checkin")==today())return msg("âŒ à¦†à¦œà¦•à§‡à¦° Check-in à¦¨à§‡à¦“à§Ÿà¦¾ à¦¹à§Ÿà§‡à¦›à§‡");
balance+=2;
localStorage.setItem("checkin",today());
save();
renderCalendar();
msg("âœ… Check-in à¦¸à¦«à¦² +2 à¦Ÿà¦¾à¦•à¦¾");
}

function dailyTask(){
if(localStorage.getItem("task")==today())return msg("âŒ à¦†à¦œà¦•à§‡à¦° Task à¦¶à§‡à¦·");
balance+=10;
localStorage.setItem("task",today());
save();
msg("âœ… Task Complete +10 à¦Ÿà¦¾à¦•à¦¾");
}

function showReferral(){
let box=document.getElementById("referralBox");
box.classList.toggle("hidden");
let link=location.origin+location.pathname+"?ref="+refCode;
let list=JSON.parse(localStorage.getItem("refList")||"[]");
box.innerHTML=`
<b>ğŸ”— Your Referral Code:</b> ${refCode}<br>
<b>ğŸ“ Link:</b><br>${link}<br><br>
<b>ğŸ‘¥ Referral History (${list.length}):</b><br>
${list.length?list.join("<br>"):"No referrals yet"}
`;
}

function withdraw(){
if(balance<130)return msg("âŒ Withdraw à¦®à¦¿à¦¨à¦¿à¦®à¦¾à¦® 130 à¦Ÿà¦¾à¦•à¦¾");
balance=0;
save();
msg("âœ… Withdraw Request Sent");
}

function renderCalendar(){
calendar.innerHTML="";
let d=new Date().getDate();
for(let i=1;i<=7;i++){
let s=document.createElement("span");
s.innerText="Day "+i;
if(i<=d%7)s.classList.add("checked");
calendar.appendChild(s);
}
}

function msg(t){document.getElementById("msg").innerText=t}
function today(){return new Date().toDateString()}
function goBack(){earn.classList.add("hidden");home.classList.remove("hidden")}
</script>

</body>
  </html>
